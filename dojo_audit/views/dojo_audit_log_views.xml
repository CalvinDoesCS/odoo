<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <!-- ═══════════════════════════════════════════════════════════════
         dojo.audit.log  – List (primary view)
    ═══════════════════════════════════════════════════════════════════ -->
    <record id="view_dojo_audit_log_list" model="ir.ui.view">
        <field name="name">dojo.audit.log.list</field>
        <field name="model">dojo.audit.log</field>
        <field name="arch" type="xml">
            <list string="Audit Log" create="false" edit="false" delete="false"
                  default_order="timestamp desc">
                <field name="timestamp" />
                <field name="event_type" />
                <field name="user_id" />
                <field name="partner_id" />
                <field name="model_name" />
                <field name="record_name" />
                <field name="summary" />
                <field name="ip_address" />
            </list>
        </field>
    </record>

    <!-- ═══════════════════════════════════════════════════════════════
         dojo.audit.log  – Form
    ═══════════════════════════════════════════════════════════════════ -->
    <record id="view_dojo_audit_log_form" model="ir.ui.view">
        <field name="name">dojo.audit.log.form</field>
        <field name="model">dojo.audit.log</field>
        <field name="arch" type="xml">
            <form string="Audit Log Entry" create="false" edit="false" delete="false">
                <sheet>
                    <group>
                        <group>
                            <field name="timestamp" readonly="1" />
                            <field name="event_type" readonly="1" />
                            <field name="user_id" readonly="1" />
                            <field name="ip_address" readonly="1" />
                        </group>
                        <group>
                            <field name="partner_id" readonly="1" />
                            <field name="model_name" readonly="1" />
                            <field name="record_id" readonly="1" />
                            <field name="record_name" readonly="1" />
                        </group>
                    </group>
                    <group>
                        <field name="summary" readonly="1" nolabel="1" />
                    </group>
                    <group>
                        <field name="old_values" readonly="1" nolabel="1"
                               widget="code" options="{'mode':'json'}" />
                    </group>
                    <group>
                        <field name="new_values" readonly="1" nolabel="1"
                               widget="code" options="{'mode':'json'}" />
                    </group>
                    <group string="Extra" attrs="{'invisible': [('extra_data','=',False)]}">
                        <field name="extra_data" readonly="1" nolabel="1"
                               widget="code" options="{'mode':'json'}" />
                    </group>
                </sheet>
            </form>
        </field>
    </record>

    <!-- ═══════════════════════════════════════════════════════════════
         dojo.audit.log  – Search
    ═══════════════════════════════════════════════════════════════════ -->
    <record id="view_dojo_audit_log_search" model="ir.ui.view">
        <field name="name">dojo.audit.log.search</field>
        <field name="model">dojo.audit.log</field>
        <field name="arch" type="xml">
            <search string="Search Audit Logs">
                <field name="partner_id" />
                <field name="user_id" />
                <field name="model_name" />
                <field name="summary" />
                <filter string="Logins" name="logins" domain="[('event_type','=','login')]" />
                <filter string="Member Changes" name="member_changes"
                        domain="[('event_type','in',['create','write']),('model_name','=','res.partner')]" />
                <filter string="Today" name="today"
                        domain="[('timestamp','>=',datetime.datetime.now().strftime('%Y-%m-%d 00:00:00'))]" />
                <separator />
                <group>
                    <filter name="group_event" string="Event Type" context="{'group_by':'event_type'}" />
                    <filter name="group_user" string="User" context="{'group_by':'user_id'}" />
                    <filter name="group_model" string="Model" context="{'group_by':'model_name'}" />
                    <filter name="group_day" string="Day" context="{'group_by':'timestamp:day'}" />
                </group>
            </search>
        </field>
    </record>

    <!-- ═══════════════════════════════════════════════════════════════
         Action
    ═══════════════════════════════════════════════════════════════════ -->
    <record id="action_dojo_audit_log" model="ir.actions.act_window">
        <field name="name">Audit Log</field>
        <field name="res_model">dojo.audit.log</field>
        <field name="view_mode">list,form</field>
        <field name="context">{'create': False}</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">No audit events recorded yet.</p>
            <p>The audit log is written automatically when members are created or updated,
               and when users log in.</p>
        </field>
    </record>

</odoo>
